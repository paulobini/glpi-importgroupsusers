import csv
import mysql.connector
import os

rootpath = os.getcwd()
csvfile = os.path.join(rootpath,'csv/usuariosxgrupos.csv')

server = 'srvglpi-hom.cetesb.local'
database = 'glpi'
username = 'glpi'
password = 'MySQLPass'

cnx = mysql.connector.connect(user=username, password=password, host=server, database=database)
cursor = cnx.cursor()
cont = 1

with open(csvfile, 'r') as file:
    reader = csv.reader(file, delimiter = ';')
    for linha in reader:
        login = linha[0]
        area = linha[1]
        gerente = linha[2]
        delegar= linha[3]
        campos = (login, area, gerente, delegar,)
        insercao = ("insert into glpi_groups_users (users_id, groups_id, is_dynamic, is_manager, is_userdelegate)"
                "values("
	            "(select id from glpi_users where name = %s),"
                "(select id from glpi_groups where name = %s),"
                "(0),"
                "(%s),"
                "(%s)"
                ");")
        if cont != 1:
            try:
                cursor.execute(insercao, campos)
            except:
                None
        cont = cont+1

cnx.commit()
cnx.close()